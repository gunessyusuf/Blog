@model HomeIndexViewModel
@*Generated by ScaffoldApp.*@
@*Model namespace using directive should be added to _ViewImports.cshtml.*@

@{
    ViewData["Title"] = "Report";
}

<partial name="_Filters" model="Model" />
<hr />
<partial name="_Report" model="Model.Report" />
<hr />
<partial name="_FormGroupBy" />
<hr />
<partial name="_ReportGroupBy" model="Model.ReportGroupBy" />

@section Scripts {
    <script src="~/lib/jquery-ajax-unobtrusive/jquery.unobtrusive-ajax.min.js"></script>

    <link href="~/lib/jquery-datetimepicker/jquery.datetimepicker.min.css" rel="stylesheet" />
    <script src="~/lib/jquery-datetimepicker/jquery.datetimepicker.full.min.js"></script>

    <link href="~/lib/select2/css/select2.min.css" rel="stylesheet" />
    <script src="~/lib/select2/js/select2.min.js"></script>

    <script>
        // $(function () {
        $(document).ready(function (event) {
            // $("#clear").click(function (event) {
            $(document).on("click", "#clear", function (event) { 
                event.preventDefault();
                $(".textbox").val("");

                // $("#roles").val("");
                // $("#users").val("");
                // $("#tags").val([]);

                $(".select2").val(null).trigger('change');
               
                $("#form").submit();

                $("#reportGroupBy").empty();
            });

            // $.datetimepicker.setLocale('tr');
            // $(".datetimepicker").datetimepicker({
            //     timepicker: true,
            //     // format: 'd.m.Y',
            //     // i18n: {
            //     //     tr: {
            //     //         months: [
            //     //             'Ocak', 'Şubat', 'Mart', 'Nisan',
            //     //             'Mayıs', 'Haziran', 'Temmuz', 'Ağustos',
            //     //             'Eylül', 'Ekim', 'Kasım', 'Aralık'
            //     //         ],
            //     //         dayOfWeek: [
            //     //             "Paz", "Pzt", "Sal", "Çar",
            //     //             "Per", "Cum", "Cmt"
            //     //         ]
            //     //     }
            //     // }
            // });

            $(".datetimepicker").datetimepicker({
                timepicker: false,
                format: 'm/d/Y'
            });

            $("#roles").change(function () {
                $("#users").empty();
                $("#users").append('<option value="">-- All Users -- </option>');
                var selectedRoleId = $("#roles").val();
                if (selectedRoleId != "") {
                    $.getJSON( // AJAX: Asynchronous Javascript and XML
                        "/Users/GetUsersByRole", // url
                        { roleId: selectedRoleId }, // data
                        function (users) { // success
                            for (const user of users) {
                                $("#users").append('<option value="' + user.id + '">' + user.userName + '</option>');
                            }
                        }
                    );
                }
            });

            $(".select2").select2();
        });
    </script>
}
